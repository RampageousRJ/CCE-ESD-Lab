	AREA RESET,DATA,READONLY
	EXPORT __Vectors
	
__Vectors
	DCD 0x10001000
	DCD Reset_Handler
	ALIGN
	AREA count,CODE,READONLY
	ENTRY
	EXPORT Reset_Handler

Reset_Handler
	LDR R0,=SRC
	LDR R1,[R0]
	MOV R2,#0
	BL COUNT
	LDR R0,=DST
	STR R2,[R0]
	B STOP

COUNT
	PUSH {R14}
	AND R0,R1,#1
	MOV R1,R1,LSR #1
	CMP R1,#0
	BEQ EXIT
	CMP R0,#1
	BEQ INC
	BNE COUNT

EXIT
	POP {R14}
	CMP R0,#1
	BNE DONE
	
INCR
	ADD R2,R2,#1
	
DONE 
	BX LR

INC
	ADD R2,R2,#1
	B COUNT
	
STOP
	B STOP

SRC DCD 0xFFE00001

	AREA dataseg,DATA,READWRITE
DST DCD 0

	END